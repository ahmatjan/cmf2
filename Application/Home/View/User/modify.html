<include file="Public/publicheader" />
<div class="container tc-main">
    <div class="row">
        <div class="span6 offset3">
            <h2 class="text-center">修改账号</h2>
            <form class="form-horizontal J_ajaxForm" action="{$siteInfo['webFolder']}user/doModify" method="post">
                <input type="hidden" id="input_userid" name="userid", value="{$userInfo['id']}">

                <div class="control-group">
                    <label class="control-label" for="input_password">密码(留空为不修改)</label>
                    <div class="controls">
                        <input type="password" id="input_password" name="password"  class="span3">
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label" for="input_repassword">重复密码</label>
                    <div class="controls">
                        <input type="password" id="input_repassword" name="repassword" class="span3">
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label" for="input_sex">性别</label> &nbsp;&nbsp;&nbsp;
                    <select id="input_sex" name="sex">
                        <option value="男" selected>男</option>
                        <option value="女" >女</option>
                    </select>
                </div>

                <div class="control-group">
                    <label class="control-label" for="input_company">工作单位</label>
                    <div class="controls">
                        <input type="text" id="input_company" name="company" value="{$userInfo['company']}" class="span3">
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label" for="input_department">部门</label>
                    <div class="controls">
                        <input type="text" id="input_department" name="department"  value="{$userInfo['department']}" class="span3">
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label" for="input_job">职务</label>
                    <div class="controls">
                        <input type="text" id="input_job" name="job"  value="{$userInfo['job']}" class="span3">
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label" for="input_email">邮箱</label>
                    <div class="controls">
                        <input type="text" id="input_email" name="email" value="{$userInfo['email']}" class="span3">
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label" for="input_contact">联系方式</label>
                    <div class="controls">
                        <input type="text" id="input_contact" name="contact"  value="{$userInfo['contact']}" class="span3">
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label" for="input_truename">真实姓名</label>
                    <div class="controls">
                        <input type="text" id="input_truename" name="truename"  value="{$userInfo['truename']}" class="span3">
                    </div>
                </div>



                <div class="control-group">
                    <label class="control-label" for="input_repassword"></label>
                    <div class="controls">
                        <button class="btn btn-primary J_ajax_submit_btn" type="button" data-wait="1500">确定更新</button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <script type="text/javascript">
        $(document).ready(function(){
            $('.J_ajax_submit_btn').click(function(){
                var userid = $.trim($('#input_userid').val());
                var sex = $.trim($('#input_sex').val());
                var truename = $.trim($('#input_truename').val());
                var password = $.trim($('#input_password').val());
                var company = $.trim($('#input_company').val());
                var department = $.trim($('#input_department').val());
                var job = $.trim($('#input_job').val());
                var email = $.trim($('#input_email').val());
                var contact = $.trim($('#input_contact').val());

                if(password != $.trim($('#input_repassword').val())){
                    alert('两次输入的密码不一致');
                    return;
                }


                $.post('doModify', {
                    userid: userid,
                    sex: encodeURIComponent(sex),
                    truename: encodeURIComponent(truename),
                    password: password,
                    company: encodeURIComponent(company),
                    department: encodeURIComponent(department),
                    job:encodeURIComponent(job),
                    email: encodeURIComponent(email),
                    contact: encodeURIComponent(contact)
                }, function(data){
                    switch(data){
                        case 'success':
                            alert('更新成功');
                            location.href = '../index';
                            break;
                        default:
                            alert('提交过程发生错误，请联系管理员');
                    }
                })
            })
        })
    </script>
    <include file="Public/indexfooter" />